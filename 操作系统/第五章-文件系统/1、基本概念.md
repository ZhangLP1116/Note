> 文件系统：是操作系统中对存储在磁盘上数据进行管理的子系统。其作用是使得使用者可以便捷的找到硬盘中存储的数据。并且以文件的形式展示给用户。简化用户对计算机的使用。

> **文件系统**和**文件**定义，文件系统是对持久性存储介质管理的一种抽象。文件时存储介质中一小块数据单元的抽象。
>
> ![image-20210226182920277](image\image-20210226182920277.png)
>
> 文件系统的功能
>
> 1、存储介质中的那一块属于哪一个文件，怎么存储一个文件
>
> 2、怎么找到一个文件，将文件名和文件如何向关联
>
> 3、保护文件安全
>
> ![image-20210226183352885](image\image-20210226183352885.png)
>
> 文件需要体现的消息
>
> ![image-20210226183753212](image\image-20210226183753212.png)

> 文件描述符（编程者角度需要关注的点）：时在打开文件操作后，操作系统会返回一个文件描述符，给进程后续对这个文件进行写操作或读操作提供索引。操作系统会为每一个进程维护一个打开文件表，其中描述符就是表的索引，表项保存着文件的一些信息，进程要使用这些文件时就需要通过描述符进行访问。（描述符一般为整性）
>
> ![image-20210226183959830](image\image-20210226183959830.png)
>
> 被打开文件的管理
>
> ![image-20210226210115103](image\image-20210226210115103.png)
>
> 不同角度看待文件的形式
>
> ![image-20210226210421304](image\image-20210226210421304.png)
>
> 文件系统对文件操作案例：**文件系统以块为单位操作文件**
>
> 1、当用户要读取一个文件的2-12字节时，文件系统会读取对应文件中对应字节所在的块到内存中，将2-12字节的内容返回。
>
> 2、写内容时也是，读取块，将内如写入块，将块写回磁盘
>
> ![image-20210226210635955](image\image-20210226210635955.png)
>
> 访问文件的方式
>
> ![image-20210226211232082](image\image-20210226211232082.png)
>
> 基于内容访问的典型例子就是数据库，它维护两个文件，索引文件将关键字和具体文件地址对应关系保存。索引到关系文件中的具体位置
>
> ![image-20210226211317085](image\image-20210226211317085.png)

> 文件内部结构
>
> 1、无结构型文件：如二进制文件
>
> 2、简单记录结构：列
>
> 3、复杂结构：word，exe
>
> ![image-20210226211518485](image\image-20210226211518485.png)
>
> 文件结构对应特定应用有效，只有特定应用才回去处理特定的文件，**文件系统不区分文件结构，一律按照字节流处理，它只对文件进行简单的处理，不进行复杂的解析，解析工作由对应的应用完成。**

> 文件访问控制：多用户下的文件访问控制
>
> ![image-20210226211942034](image\image-20210226211942034.png)
>
> 多用户，多进程下访问同一个进程时的处理
>
> ![image-20210226212207385](image\image-20210226212207385.png)

> 目录：时便于用户查找文件，使得磁盘中的文件具有层次性。对文件进行划分。
>
> 目录是一种特殊的文件，用来保存索引信息
>
> ![image-20210226212651410](image\image-20210226212651410.png)
>
> 对目录的操作
>
> 1、收索目录：收索文件操作
>
> 2、修改目录：创建文件操作、删除文件操作、重命名文件
>
> 3、遍历目录：枚举文件操作
>
> 对应目录的操作都是由操作系统来完成，可以由应用程序发出请求。
>
> ![image-20210226212840640](image\image-20210226212840640.png)
>
> 目录的存储形式（数据结构由介绍）
>
> ![image-20210226213118766](image\image-20210226213118766.png)
>
> 路径遍历：访问文件时就需要通过对目录进行遍历得到一个文件的路径，才能找到对应的文件。
>
> 绝对路径遍历：路径从根目录出发一层层查找到对应的文件，如下图中的/bin/ls查找
>
> 相对路径：每个进程本身就会指向一个文件的索引，这个索引是该进程静态文件的位置，在创建进程是会携带这个索引，可以通过**以这个索引为锚点来实现相对路径的查找**。可以加快访问速度。
>
> ![image-20210226213206086](image\image-20210226213206086.png)
>
> 文件系统的挂载，在类linux系统中文件系统需要挂载在相应的目录下才能被使用，也就是说对应的文件需要被挂载后才能被使用。
>
> ![image-20210226214227935](image\image-20210226214227935.png)

> 文件别名：一个文件资源可以被两个文件名所关联
>
> 软连接：文件的内容保存的是另一个文件的路径，类似快捷方式的访问
>
> ![image-20210226214809830](image\image-20210226214809830.png)
>
> 删除一个由别名的文件
>
> 1、软连接文件指向的文件被删除时，会造成悬空指针
>
> 2、硬连接文件被删除时只是删除了文件项中的一个文件计数、只有文件计数归零时文件才被真正的删除。
>
> 由以下两种处理方法
>
> ![image-20210226215209860](image\image-20210226215209860.png)
>
> 别名机制带来目录文件成环问题
>
> ![image-20210226215647495](image\image-20210226215647495.png)

> 文件系统类别
>
> windows：早期FAT、现在NTFS
>
> unix：ext2/3/4
>
> 光盘文件系统：ISO9660
>
> 日志文件系统：用于计算机非正常断电导致内存数据没有写回硬盘导致数据丢失，使用日志来保证下一次上电后可以恢复这些数据，日志文件系统现在被NTFS/ext4等包含在内
>
> 网络文件系统：NFS、SMB，如在windows中可以便捷的访问同一局域网内其他计算机中的文件。就是通过NFS文件系统实现
>
> 分布式文件系统：AFS，GFS，在网络中心、数据中心等设施中通过分布式文件系统管理集群中的所有文件。
>
> 特殊文件系统：如unix中proc文件夹，其中可以查看到系统中存在多少个进程，CPU使用率等信息。产生多少次中断等。
>
> ![image-20210226215857143](image\image-20210226215857143.png)

> 网络、分布式文件系统由于网络传输延迟的影响需要重点考虑文件读写一致性，可靠性，安全性等问题。
>
> ![image-20210226221110904](image\image-20210226221110904.png)