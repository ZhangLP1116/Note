> 进程调度算法
>
> 为了高效的使用CPU，操作系统需要对各各进行占用CPU的资源进行控制，当一个进程处于等待状态时他就不需要继续占用CPU资源，此时操作系统就需要选中一个进程出来使用CPU，这个选择的过程就是CPU调度算法执行的过程。
>
> 
>
> 什么时候发生调度
>
> 当进程状态发生变迁的时候就会触发系统调度，特别是与running相关的状态变迁时
>
> 
>
> 操作系统运行调度的条件
>
> ![image-20210217142121286](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217142121286.png)
>
> 抢占非为，用户空间抢占内核空间不可抢占，用户空间内核空间均可抢占

> 进程在计算机系统中的行为
>
> 大概有这几种，访问内存，访问I/O，让CPU计算。进程执行模型如下。
>
> ![image-20210217142833678](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217142833678.png)
>
> 从模型中可以看出，进程在执行过程中，对CPU的使用存在计中在一个时间断内，其余时间CPU都处于空间状态。基于这个特点，操作系统可以在这个进程不使用CPU时将其他需要使用CPU的进程占用CPU。
>
> （整个计算机看起来就像一个工厂，硬件时工厂里的工具，进程时工厂里的产品，它们的整个制作过程就是使用不同工具加工的过程。）

> 调度算法评价指标
>
> ![image-20210217143754093](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217143754093.png)
>
> 
>
> 如何达到“更快的服务”
>
> ![image-20210217144234655](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217144234655.png)
>
> 
>
> 调度算法需要达到的要求
>
> ![image-20210217144536483](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217144536483.png)
>
> 
>
> 另一个调度算法的指标
>
> ![image-20210217144811066](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217144811066.png)

> 调度算法
>
> ![image-20210217145508636](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217145508636.png)
>
> FCFS算法（无抢占）
>
> ![image-20210217145833336](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217145833336.png)
>
> ![image-20210217150023355](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217150023355.png)
>
> 
>
> 短任务优先（由非抢占和可抢占型）
>
> 非抢占型（SPN）：选则就绪中剩余执行时间最小的进程进行执行，若有剩余执行时间更小的进程加入就绪队列也不切换进程
>
> 抢占型（SRT）：选则就绪中剩余执行时间最小的进程进行执行，若有剩余执行时间更小的进程加入就绪队列就进行进程切换，执行剩余时间小的进程
>
> ![image-20210217150159449](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217150159449.png)
>
> 短任务优先的平均周转时间计算如下，该算法就是一最小周转时间为目的设计的算法
>
> ![image-20210217151012611](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217151012611.png)
>
> 短任务优先算法存在的问题
>
> ![image-20210217151155606](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217151155606.png)
>
> 进程执行时间预估公式：该公式根据进程过去的执行时间预估未来进程可能需要的执行时间
>
> ![image-20210217151703947](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217151703947.png)
>
> ![image-20210217151754226](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217151754226.png)
>
> 
>
> 最高响应比优先算法（是对SPN算法的优化，不可抢占，防止长任务饿死）：选中R值最高的任务执行
>
> ![image-20210217151902541](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217151902541.png)
>
> 
>
> 轮询调度算法（Round Robin）
>
> ![image-20210217162954926](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217162954926.png)
>
> ![image-20210217163010941](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217163010941.png)
>
> ![image-20210217163314470](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217163314470.png)
>
> ![image-20210217163455353](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217163455353.png)
>
> 优化FCFS和轮询：划分不同的队列，使用不同的调度算法
>
> ![image-20210217163720430](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217163720430.png)
>
> ![image-20210217163855665](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217163855665.png)
>
> 
>
> FFS算法：强调公平性，在用户级别实现公平的资源共享
>
> ![image-20210217164220198](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217164220198.png)

> 实时操作系统中的调度算法
>
> 实时系统定义，在规定时间内要完成任务，该系统的特点就是确定性和可预测性
>
> ![image-20210217164912554](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217164912554.png)
>
> ![image-20210217165048444](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165048444.png)
>
> 该系统中的进程执行
>
> ![image-20210217165417615](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165417615.png)
>
> ![image-20210217165426983](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165426983.png)
>
> ![image-20210217165524296](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165524296.png)
>
> ![image-20210217165550703](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165550703.png)
>
> 
>
> 调度算法
>
> ![image-20210217165712075](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165712075.png)

> 多核CPU下的操作系统调度算法
>
> ![image-20210217165955621](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217165955621.png)

> 优先级反转
>
> ![image-20210217170231007](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217170231007.png)
>
> T1>T2>T3，T1执行需要T3执行完毕。在T3运行时，T2抢占了T3运行的时间片。导致需要执行的时候无法执行。也就导致了T2优先级低但是T1需要等待T2执行完毕后，T3执行完毕在执行。**导致发生优先级反转现象**
>
> ![image-20210217170321805](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217170321805.png)
>
> 解决方法
>
> 存在依赖性关系的不同优先级任务，低优先级继承高优先级任务的优先等级。
>
> ![image-20210217170739464](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217170739464.png)
>
> 优先级天花板
>
> ![image-20210217171121410](C:\Users\zhang\AppData\Roaming\Typora\typora-user-images\image-20210217171121410.png)