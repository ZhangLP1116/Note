### JVM阅读书目

![image-20211126131658013](image/image-20211126131658013.png)

![image-20211126131815415](image/image-20211126131815415.png)

![image-20211126131821358](image/image-20211126131821358.png)



### JVM跨语言的平台

不同的语言都可以提供符合规范的字节码文件交给JVM来运行

![image-20211126132744600](image/image-20211126132744600.png)

![image-20211126133025168](image/image-20211126133025168.png)

JVM相比Java语言来说更加是一个成功的产品，java语言可能不是最强大的语言，但Java虚拟机是最强大的虚拟机



### 多语言混合编程

![image-20211126135319047](image/image-20211126135319047.png)

### JVM历史事件

![image-20211126135149163](image/image-20211126135149163.png)



### Java虚拟机

![image-20211126135757920](image/image-20211126135757920.png)



### JVM的位置

![image-20211126140534622](image/image-20211126140534622.png)

![image-20211126140603614](image/image-20211126140603614.png)

### JVM的整体结构

![image-20211126154627189](image/image-20211126154627189.png)

- 类加载器：将字节码文件解析为一定的数据结构保存在运行时数据区，其中方法区和堆区是所有线程共享的，java栈，本地方法栈，程序计数器是线程私有的。

- 本地方法区：是C++库

- 执行引擎：是用来输出对应机器代码的模块



### Java执行流程

![image-20211126141616733](image/image-20211126141616733.png)



### JVM架构模型

JVM采用基于栈的指令集架构，另一种物理机上的指令集架构是基于寄存器的

- 基于栈的指令集架构
  - 设计和实现简单，适用于资源受限的系统
  - 避开了寄存器分配难题（NP问题），使用零地址格式来设计指令，一个指令占用8bit
  - 指令集小，执行过程依赖栈操作
  - 编译器容易实现
  - 不需要硬件支持，移植性号
- 基于寄存器的指令架构
  - 典型应用是x86芯片，Android的Davlik虚拟机
  - 指令集和硬件高度耦合，移植性差
  - 效率高、性能优秀
  - 用更少的指令完成一个操作
  - 指令往往采用一地址、二地址、三地址的格式设计，每个指令占16为或更多

![image-20211126143831393](image/image-20211126143831393.png)



### JVM生命周期

1. 启动：java虚拟机的启动是通过`引导类加载器`(bootstrap class loader)创建一个初始类来完成的，这个类由虚拟机的具体实现指定
2. 执行：运行的JVM有一个清晰的任务——执行java程序，程序开始执行是它才运行，程序结束时它就停止。`一个java程序在JVM中体现为一个进程`
3. 退出：有多种退出情况
   1. 程序正常执行结束
   2. 执行过程中遇到异常或者错误
   3. 由于操作系统错误导致java虚拟机进程终止
   4. 某线程调用Runtime类或System类的exit()方法，或Runtime中的halt方法，并且java安全管理器也允许这次exit()或halt()操作
   5. 用JNI在加载或卸载java虚拟机



### JVM发展历程

- Sun Class VM
  ![image-20211126150637707](image/image-20211126150637707.png)
- Exact VM
  ![image-20211126151204940](image/image-20211126151204940.png)
- HotSlop VM
  ![image-20211126151302702](image/image-20211126151302702.png)
- JRockit（商用）
  ![image-20211126151916003](image/image-20211126151916003.png)
- J9 VM（IBM公司开发的商用虚拟机）
  ![image-20211126152329172](image/image-20211126152329172.png)
- 其他虚拟机
  ![image-20211126152836376](image/image-20211126152836376.png)
  ![image-20211126152957845](image/image-20211126152957845.png)
  ![image-20211126153019136](image/image-20211126153019136.png)
  ![image-20211126153143690](image/image-20211126153143690.png)
  ![image-20211126153209965](image/image-20211126153209965.png)
  ![image-20211126153249809](image/image-20211126153249809.png)
  ![image-20211126153652305](image/image-20211126153652305.png)

![image-20211126154000878](image/image-20211126154000878.png)

### JVM展望

![image-20211126154049678](image/image-20211126154049678.png)