1、事务概述

> 事务是用户达成一个目的的所有操作的集合。
>
> 用户对数据库的所有操作都是一个个事务。
>
> 数据库事务由以下4点要求：
>
> 1、用户能将每一事务的执行当作原子的，即一个事务的所有操作要么全部执行，要么全部不执行。不会发生事务被部分执行的情况。
>
> 2、在多个事务并发执行的情况下，每个事务都是各自独立的，它既不干涉别的事务，也不受到别的事务的干涉。
>
> 3、在隔离执行事务时，必须保证数据库中数据在操作前后是一致的。
>
> 4、事务执行成功后，其结果是永久的。
>
> 由以上事务的要求也就引出了以下事务的特点

2、事务的特性

> 1、原子性：事务中包含的操作要么全做要么全部不做
>
> 导致事务夭折的情况大概有3种：
> 1、出现意外被DBMS终止
> 2、电源或硬件故障或软件错误使得系统宕机
> 3、事务遇到了预料之外的错误，如无法读取磁盘数据
>
> Q：如何处理事务夭折后的现场?
> A：将夭折的事务之前的此操作抹去，==DBMS中有一个事务日志==，其中记录了事务操作前后的新值与旧值。通过undo命令将不完整的事务操作影响抹去，该操作在“故障与恢复中有详细使用”

> 2、一致性：事务的操作前后，数据库中的数据要满足业务规则约束，要满足常理逻辑
>
> DBMS无法自动实现每一事务的一致性，不同的事务具有不同的约束规则。可以通过一些==数据完整性规则==来达到一致性目的——一般常用用户自定义约束

> 3、隔离性：在数据库允许多个事务并发执行的同时，防止操作命令交叉执行而导致数据不一致。
>
> DBMS实现隔离性的原理是，是多个并发事务的结果等价于它们一个接一个的串行执行的结果。这一功能有==DBMS并发控制部件==完成

> 4、持续性：事务处理结束后，它对数据的修改是永久性的，即使系统遇到故障的情况下也不会丢失
>
> 事务持续性问题的关键有两点：
> 1、事务代码执行结束，结果在内存中还未写到磁盘中，此时发生故障怎么恢复
> 2、执行结果协会磁盘，但物理磁盘受到破坏
>
> ==DBMS提供日志设施==，来记录每一事务的操作信息，无论发生什么故障都可以通过该日志来恢复，所以事务持久性的是DBMS的恢复管理部件

