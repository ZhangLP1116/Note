0、概述

> 数据库恢复的基本原则是数据冗余，建立冗余数据的常用手段就是数据备份和登记日志文件

1、数据备份

> 数据备份的基本方法就是定期将数据库心转存储到令一个安全的存储器（磁带，光盘）
>
> 怎么进行转存储
> （1）：海量转存储：每次都将整个数据库复制一份
> （2）：增量转存储：每次只转存储上次转存储后新增或更新的数据
>
> 什么时候进行转存储
> （1）：静态转存储：在当前事务结束后，进行转存储操作，后续的事务要在转存储完成后进行。它得到的是一个数据一致性的副本，但降低的系统的可用性。
> （2）：动态转存储：不用等待只在运行的使用结束，也不会阻塞后续事务的开始。它得到的副本不一定是正确的有效的。

2、日志登记

> 在两次转存储之间发生的故障，其数据恢复就要靠日志来完成。日志会记录系统运行期间事务所带来的变化，以便在故障后能正确的恢复系统。
>
> 日志记载的内容：
> （1）：事务的唯一标识
> （2）：事务的输入数据
> （3）：事务的开始
> （4）：事务的提交：它的变更不一定写入磁盘
> （5）：事务的夭折
> （6）：事务完全结束：仅有commit或abort日志记录是不够的，因为此后还有一些活动必须完成，如事务所占的工作缓存等。
> （7）：事务在数据对象上进行的操作，增删改查等
> （8）：事务更新前数据的旧值
> （9）：事务更新后数据的新值
> （10）：备份记录：转存储的类型，转存储的版本号
> （11）：检查点记录：在做检查点时正在运行的事务，每一种事务最后一个日志记录的标记号，第一个日志记录的标记号。
>
> 日志的登记：
> （1）：事务登记的次序必须严格按照并发事务执行的时间次序
> （2）：必须先写日志，后写数据库